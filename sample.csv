"id";"question";"answer";"category";"difficulty_level";"tags";"example_query";"explanation";"common_mistakes";"related_questions"
"1";"What is a CTE (Common Table Expression)?";"A CTE is a temporary result set that you can reference within a SELECT, INSERT, UPDATE, or DELETE statement.";"SQL";"Intermediate";"CTE, SQL, Data Analysis";"WITH Sales_CTE AS (SELECT * FROM sales WHERE amount > 100) SELECT * FROM Sales_CTE;";"CTEs improve readability and organization of complex queries.";"Confusing CTE with views; not knowing scope limits.";"What are temporary tables?; Explain subqueries."
"2";"What is the difference between UNION and UNION ALL?";"UNION combines the result sets of two or more SELECT statements while removing duplicates; UNION ALL includes duplicates.";"SQL";"Intermediate";"UNION, SQL";"SELECT id FROM tableA UNION SELECT id FROM tableB;";"Use UNION for distinct values across results; use UNION ALL for performance when duplicates are acceptable.";"Misunderstanding result sets and performance implications.";"What is a JOIN?; Explain set operations."
"3";"How would you optimize a slow-running query?";"You can optimize a slow-running query by creating indexes, analyzing query execution plans, and reducing complexity.";"SQL";"Advanced";"Query Optimization, SQL";"SELECT * FROM Sales WHERE YEAR(sale_date) = 2022; CREATE INDEX idx_sale_date ON Sales(sale_date);";"Query optimization techniques can improve performance and reduce resource consumption.";"Not considering index creation and analysis.";"What is indexing?; Explain execution plans."
"4";"What is a primary key?";"A primary key is a unique identifier for each record in a table, ensuring that no two rows have the same key.";"SQL";"Easy";"Primary Key, SQL";"CREATE TABLE users (id INT PRIMARY KEY, name VARCHAR(100));";"Primary keys help maintain data integrity and establish relationships.";"Confusing primary keys with foreign keys.";"What is a composite key?; Explain foreign key."
"5";"What is normalization?";"Normalization is the process of organizing data to reduce redundancy and improve data integrity.";"SQL";"Intermediate";"Normalization, Database";"Normalization typically involves dividing a database into tables and defining relationships.";"Normalization improves data integrity but can complicate queries.";"Over-normalizing can lead to performance issues.";"What are normal forms?; Explain denormalization."
"6";"How do you handle NULL values in SQL?";"You can handle NULL values using the IS NULL and IS NOT NULL operators.";"SQL";"Intermediate";"NULL Handling, SQL";"SELECT * FROM users WHERE middle_name IS NULL;";"Proper handling of NULLs prevents unexpected behavior.";"Confusing NULL with an empty string or zero.";"What is the COALESCE function?; Explain ISNULL."
"7";"What is a foreign key?";"A foreign key is a field (or group of fields) in one table that uniquely identifies a row in another table.";"SQL";"Intermediate";"Foreign Key, SQL";"CREATE TABLE orders (order_id INT PRIMARY KEY, user_id INT FOREIGN KEY REFERENCES users(id));";"Foreign keys enforce referential integrity between tables.";"Confusing foreign key constraints with primary keys.";"What is a self-referencing relationship?; Explain cascading actions."
"8";"What are window functions?";"Window functions perform calculations across a set of rows related to the current row.";"SQL";"Advanced";"Window Functions, SQL";"SELECT name, RANK() OVER (ORDER BY score DESC) as rank FROM players;";"Window functions allow advanced calculations like running totals.";"Overusing window functions can lead to performance issues.";"Explain ROW_NUMBER(); What is the difference between RANK() and DENSE_RANK()?"
"9";"What is a self-join?";"A self-join is a regular join that joins a table to itself to combine rows based on related columns.";"SQL";"Intermediate";"Self Join, SQL";"SELECT A.name, B.name FROM employees A, employees B WHERE A.manager_id = B.id;";"Self-joins can be useful for hierarchical data.";"Not aliasing correctly can cause confusion.";"What is a CROSS JOIN?; Explain recursive queries."
"10";"What are indexes?";"An index is a database object that speeds up data retrieval operations on a table.";"SQL";"Intermediate";"Indexes, SQL";"CREATE INDEX idx_name ON employees(name);";"Indexes improve data retrieval speed but add storage costs.";"Over-indexing can slow down INSERT operations.";"What is a composite index?; Explain covering index."
"11";"Explain the difference between clustered and non-clustered indexes.";"A clustered index determines the physical order of data in a table; a non-clustered index creates a separate structure.";"SQL";"Advanced";"Index Types, SQL";"CREATE CLUSTERED INDEX idx_name ON employees(name); CREATE NONCLUSTERED INDEX idx_salary ON employees(salary);";"Choosing the right index is crucial for performance.";"Not understanding when to use each index type.";"What are covering indexes?; Explain index scans vs. index seeks."
"12";"What is an aggregate function?";"An aggregate function performs a calculation on a set of values and returns a single value.";"SQL";"Easy";"Aggregate Functions, SQL";"SELECT COUNT(*) FROM orders;";"Aggregate functions are essential for summarizing data.";"Misusing GROUP BY when not needed.";"What are GROUP BY and HAVING clauses?; Explain COUNT() vs. SUM()."
"13";"What is a subquery?";"A subquery is a SQL query nested inside another query.";"SQL";"Intermediate";"Subquery, SQL";"SELECT name FROM employees WHERE department_id IN (SELECT id FROM departments);";"Subqueries can be powerful but may impact performance.";"Not understanding the difference between correlated and non-correlated subqueries.";"What is an EXISTS clause?; Explain JOIN vs. subquery."
"14";"What is the purpose of the GROUP BY clause?";"The GROUP BY clause groups rows that have the same values in specified columns into aggregate data.";"SQL";"Intermediate";"GROUP BY, SQL";"SELECT department, COUNT(*) FROM employees GROUP BY department;";"GROUP BY is crucial for summarizing and aggregating data.";"Forgetting to include non-aggregated columns in SELECT.";"What is the HAVING clause?; Explain filtering groups."
"15";"What is the difference between WHERE and HAVING?";"WHERE filters records before aggregation; HAVING filters records after aggregation.";"SQL";"Intermediate";"WHERE, HAVING, SQL";"SELECT department, COUNT(*) FROM employees GROUP BY department HAVING COUNT(*) > 5;";"Understanding WHERE and HAVING is important for data filtering.";"Using HAVING instead of WHERE for simple conditions.";"What is a ROLLUP?; Explain CUBE in aggregation."
"16";"What is a JOIN in SQL?";"A JOIN is used to combine rows from two or more tables based on a related column.";"SQL";"Intermediate";"JOIN, SQL";"SELECT * FROM employees INNER JOIN departments ON employees.department_id = departments.id;";"JOINS are fundamental for retrieving related data across multiple tables.";"Not understanding different types of JOINS (INNER, LEFT, RIGHT).";"What are CROSS JOINs?; Explain OUTER JOINS."
"17";"What is a database transaction?";"A database transaction is a sequence of operations performed as a single logical unit of work.";"SQL";"Advanced";"Transactions, SQL";"BEGIN TRANSACTION; INSERT INTO accounts (id, balance) VALUES (1, 100); COMMIT;";"Transactions ensure data integrity by allowing rollback in case of errors.";"Forgetting to use COMMIT and ROLLBACK.";"Explain ACID properties; What is a rollback?"
"18";"What is a trigger?";"A trigger is a procedural code that is automatically executed in response to certain events on a table.";"SQL";"Advanced";"Triggers, SQL";"CREATE TRIGGER trg_after_insert AFTER INSERT ON employees FOR EACH ROW BEGIN ... END;";"Triggers automatically enforce business rules at the database level.";"Overusing triggers can lead to complex dependencies.";"What is a stored procedure?; How do you create a before trigger?"
"19";"What is a stored procedure?";"A stored procedure is a set of SQL statements that can be stored and executed in the database.";"SQL";"Advanced";"Stored Procedures, SQL";"CREATE PROCEDURE proc_getEmployees AS BEGIN SELECT * FROM employees; END;";"Stored procedures encapsulate business logic and improve performance.";"Not handling errors properly in stored procedures.";"What is a function?; What's the difference between a stored procedure and a function?"
"20";"What is a cursor in SQL?";"A cursor is a database object used to retrieve, manipulate, and navigate through a result set row by row.";"SQL";"Advanced";"Cursor, SQL";"DECLARE cursor_name CURSOR FOR SELECT name FROM employees;";"Cursors can be useful for processing individual rows but may lead to performance issues.";"Not properly closing the cursor after use.";"What are set-based operations?; Explain static vs. dynamic cursors."
"21";"What is data integrity?";"Data integrity refers to the accuracy and consistency of data stored in a database.";"SQL";"Intermediate";"Data Integrity, SQL";"N/A";"Ensuring data integrity is crucial for maintaining high-quality data.";"Neglecting to enforce integrity constraints.";"What are integrity constraints?; Explain referential integrity."
"22";"What is a composite key?";"A composite key is a primary key composed of two or more columns.";"SQL";"Intermediate";"Composite Key, SQL";"CREATE TABLE student_courses (student_id INT, course_id INT, PRIMARY KEY (student_id, course_id));";"Composite keys ensure uniqueness across multiple columns in a table.";"Confusing composite keys with foreign keys.";"What is a surrogate key?; Explain natural keys."
"23";"What is an inner join?";"An inner join returns records that have matching values in both tables.";"SQL";"Intermediate";"Inner Join, SQL";"SELECT * FROM employees INNER JOIN departments ON employees.department_id = departments.id;";"Inner joins are the most common type of join used in SQL.";"Not understanding how inner joins filter out non-matching records.";"What are left joins?; What is an outer join?"
"24";"What is an outer join?";"An outer join returns all records from one table and the matched records from the other.";"SQL";"Intermediate";"Outer Join, SQL";"SELECT * FROM employees LEFT JOIN departments ON employees.department_id = departments.id;";"Outer joins are useful for retrieving all data even when there are no matches.";"Misusing the type of outer join can lead to missing data.";"What is a right join?; Explain full outer join."
"25";"What are constraints in SQL?";"Constraints are rules enforced on data columns of a table to ensure accuracy and reliability.";"SQL";"Intermediate";"Constraints, SQL";"N/A";"Constraints help maintain the integrity and accuracy of data.";"Neglecting to apply constraints may lead to invalid data.";"What is a unique constraint?; Explain check constraints."
"26";"What is a logical operator in SQL?";"Logical operators are used to combine multiple conditions in a SQL statement.";"SQL";"Easy";"Logical Operators, SQL";"SELECT * FROM employees WHERE department = 'IT' AND salary > 60000;";"Logical operators allow for more complex queries and conditions.";"Misusing logical operators can lead to unexpected results.";"What is a subquery?; Explain the NOT operator."
"27";"What is a data type in SQL?";"A data type indicates the type of data that can be stored in a column.";"SQL";"Easy";"Data Types, SQL";"CREATE TABLE sample (id INT, name VARCHAR(50));";"Choosing the appropriate data type is important for data integrity and performance.";"Using incorrect data types can lead to data loss.";"What are numeric data types?; Explain date and time data types."
"28";"What is a temporary table?";"A temporary table is a table that is created and exists temporarily during a session.";"SQL";"Intermediate";"Temporary Table, SQL";"CREATE TEMPORARY TABLE temp_sales (id INT, amount DECIMAL(10,2));";"Temporary tables can be useful for bridging complex calculations without affecting permanent tables.";"Not dropping the temporary table when done.";"What is a regular table?; Explain global temporary tables."
"29";"What are data normalization forms?";"Data normalization forms define the rules and processes for structuring a relational database.";"SQL";"Intermediate";"Normalization, Forms";"N/A";"Normalization forms help define how tables relate to one another.";"Skipping normalization can lead to data anomalies.";"What is first normal form?; Explain third normal form."
"30";"What is an execution plan?";"An execution plan is a map that SQL Server uses to retrieve data.";"SQL";"Advanced";"Execution Plan, SQL";"N/A";"Understanding execution plans is essential for performance tuning.";"Neglecting to analyze execution plans can lead to inefficient queries.";"What is query optimization?; Explain indexing strategies."
"31";"What is the difference between a function and a stored procedure?";"Functions return a value and can be used in SQL statements; stored procedures perform actions and do not need to return a value.";"SQL";"Intermediate";"Functions, Stored Procedures";"N/A";"Understanding when to use a function versus a stored procedure is crucial for structuring code.";"Confusing the two can lead to improperly structured queries.";"What is a trigger?; Explain the use of parameters."
"32";"What is a common data model?";"A common data model provides a standardized way to represent data structures.";"SQL";"Intermediate";"Data Model, SQL";"N/A";"Common data models improve interoperability between systems.";"Failing to adapt the model can lead to integration issues.";"What is a data mart?; Explain dimensional modeling."
"33";"What is a data warehouse?";"A data warehouse is a central repository of integrated data from one or more disparate sources.";"SQL";"Advanced";"Data Warehouse, SQL";"N/A";"A data warehouse is designed to enable analysis and reporting.";"Confusing operational databases with data warehouses.";"What is ETL?; Explain OLAP."
"34";"What is the purpose of database views?";"Views provide a way to present data in a specific format without storing it physically.";"SQL";"Intermediate";"Views, SQL";"CREATE VIEW employee_view AS SELECT name, department FROM employees;";"Views can simplify complex queries and enhance security by restricting data access.";"Not updating views when base tables change.";"What is materialized view?; Explain indexed views."
"35";"What is the difference between DELETE and TRUNCATE?";"DELETE removes rows one at a time and logs each deletion, while TRUNCATE removes all rows and does not log individual deletions.";"SQL";"Intermediate";"Delete, Truncate, SQL";"DELETE FROM employees WHERE department = 'HR'; TRUNCATE TABLE employees;";"TRUNCATE is faster and uses fewer system resources.";"Misunderstanding the use cases for each can lead to data loss.";"What is a rollback?; Explain the use of a transaction."
"36";"What are system tables?";"System tables hold the information necessary for SQL Server to manage its data and configure itself.";"SQL";"Advanced";"System Tables, SQL";"SELECT * FROM sys.tables;";"System tables provide metadata about the database structure.";"Ignoring system tables can overlook important database aspects.";"What is a catalog view?; Explain schema."
"37";"What is a schema?";"A schema is a logical container for database objects such as tables, views, and procedures.";"SQL";"Intermediate";"Schema, SQL";"CREATE SCHEMA sales AUTHORIZATION dbo;";"Schemas help organize database objects logically.";"Confusing schemas with databases.";"What is namespace?; Explain database objects."
"38";"What is database replication?";"Database replication involves copying and distributing data between multiple databases to maintain consistency.";"SQL";"Advanced";"Replication, SQL";"N/A";"Replication ensures data availability and redundancy.";"Not understanding the types of replication can lead to data inconsistencies.";"What is transaction log?; Explain data redundancy."
"39";"What is a performance bottleneck in SQL?";"A performance bottleneck is a point where the performance of a system or query significantly slows.";"SQL";"Advanced";"Performance, SQL";"N/A";"Identifying and resolving bottlenecks is crucial for optimal performance.";"Neglecting to monitor performance regularly.";"What is query optimization?; Explain indexing strategies."
"40";"What are stored functions?";"Stored functions are similar to stored procedures; they return a single value and can be used directly in SQL statements.";"SQL";"Intermediate";"Stored Functions, SQL";"CREATE FUNCTION get_employee_count() RETURNS INT BEGIN RETURN (SELECT COUNT(*) FROM employees); END;";"Stored functions encapsulate complex logic and can simplify queries.";"Confusing stored functions with stored procedures.";"What is a cursor?; Explain database triggers."
"41";"What is DDL?";"DDL stands for Data Definition Language, which is used to define and manage all structures in a database.";"SQL";"Easy";"DDL, SQL";"CREATE, ALTER, DROP;";"DDL commands manage the schema of a database.";"Not understanding the permanent effects of DDL commands.";"What is DML?; Explain DCL."
"42";"What is DML?";"DML stands for Data Manipulation Language, which is used for querying and modifying data.";"SQL";"Easy";"DML, SQL";"INSERT, UPDATE, DELETE;";"DML allows for data retrieval and modification in the database.";"Not performing operations with transactions.";"What is SELECT?; Explain aggregations in DML."
"43";"What is the purpose of a database lock?";"Database locks are mechanisms to manage concurrent access to data and prevent data corruption.";"SQL";"Advanced";"Locks, SQL";"N/A";"Locks ensure data integrity during transactions.";"Not understanding different lock types can lead to deadlocks.";"What is isolation level?; Explain lock escalation."
"44";"What is horizontal scaling?";"Horizontal scaling involves adding more machines to a pool to distribute the load.";"SQL";"Advanced";"Scaling, SQL";"N/A";"Horizontal scaling improves performance by distributing the workload.";"Neglecting to manage the load balancing can hinder performance.";"What is vertical scaling?; Explain clustering."
"45";"What are the ACID properties?";"ACID stands for Atomicity, Consistency, Isolation, Durability; it is a set of properties ensuring reliable transaction processing.";"SQL";"Advanced";"ACID, SQL";"N/A";"Understanding ACID properties is crucial for database design.";"Neglecting one or more properties can lead to data anomalies.";"What is eventual consistency?; Explain CAP theorem."
"46";"What is a composite foreign key?";"A composite foreign key is a foreign key that consists of two or more columns.";"SQL";"Intermediate";"Composite Foreign Key, SQL";"CREATE TABLE course_enrollment (student_id INT, course_id INT, FOREIGN KEY (student_id, course_id) REFERENCES students_courses (student_id, course_id));";"Composite foreign keys enforce referential integrity across multiple columns.";"Confusing composite foreign keys with composite primary keys.";"What is cascade delete?; Explain orphaned records."
"47";"What is optimistic locking?";"Optimistic locking is a strategy to allow multiple transactions to complete without locking data.";"SQL";"Advanced";"Optimistic Locking, SQL";"N/A";"Optimistic locking avoids locking conflicts in high-concurrency environments.";"Not validating data for changes can lead to update conflicts.";"What is pessimistic locking?; Explain concurrency control."
"48";"What is a column-store index?";"A column-store index stores data in columns rather than rows, improving query performance for analytical workloads.";"SQL";"Advanced";"Column-store Index, SQL";"CREATE COLUMNSTORE INDEX idx_col ON table_name;";"Column-store indexes are optimized for large volume read queries.";"Not understanding the trade-offs between row-store and column-store.";"What is a wild card?; Explain full-text search."
"49";"What is the purpose of a data dictionary?";"A data dictionary contains metadata about database objects, such as definitions and relationships.";"SQL";"Intermediate";"Data Dictionary, SQL";"N/A";"A data dictionary provides a comprehensive view of data and its structure.";"Neglecting to maintain accurate metadata can lead to confusion.";"What is metadata?; Explain system catalog."
"50";"What is a business intelligence (BI) model?";"A BI model organizes data for analysis and reporting, often structured around dimensions and facts.";"SQL";"Advanced";"Business Intelligence, SQL";"N/A";"BI models facilitate efficient querying and analysis.";"Confusing BI modeling with transaction management.";"What is ETL?; Explain dimensional modeling."
"1";"Given a 'sales' table, write a SQL query to find the total sales amount per product for the year 2022.";"SELECT product_id, SUM(amount) as total_sales FROM sales WHERE YEAR(sale_date) = 2022 GROUP BY product_id;";"SQL";"Intermediate";"Data Analyst, Business Analyst";"SELECT product_id, SUM(amount) AS total_sales FROM sales WHERE YEAR(sale_date) = 2022 GROUP BY product_id;";"This query calculates the total sales for each product in the specified year.";"Forgetting to group by product_id.";"How to calculate average sales; What is a time series analysis?"
"2";"Write a SQL query to identify employees who have joined in the last month and have a salary greater than the average salary.";"SELECT * FROM employees WHERE join_date >= DATEADD(month, -1, GETDATE()) AND salary > (SELECT AVG(salary) FROM employees);";"SQL";"Intermediate";"Data Engineer, Business Analyst";"SELECT * FROM employees WHERE join_date >= DATEADD(month, -1, GETDATE()) AND salary > (SELECT AVG(salary) FROM employees);";"This retrieves employees based on their join date and compares their salary to the average.";"Misunderstanding date functions.";"What is a correlated subquery?; How to calculate the median salary?"
"3";"You have a table named 'transactions' with columns 'user_id', 'amount', and 'transaction_date'. Write a SQL query to get the total transaction amount for each user in the last year.";"SELECT user_id, SUM(amount) AS total_amount FROM transactions WHERE YEAR(transaction_date) = YEAR(CURRENT_DATE) - 1 GROUP BY user_id;";"SQL";"Intermediate";"Data Analyst, Financial Analyst";"SELECT user_id, SUM(amount) AS total_amount FROM transactions WHERE YEAR(transaction_date) = YEAR(CURRENT_DATE) - 1 GROUP BY user_id;";"This groups transactions by user and sums their amounts for the previous year.";"Neglecting to account for the proper fiscal year.";"What are aggregate functions?; How to use date functions in SQL?"
"4";"Assuming a table 'inventory' with 'item_id', 'warehouse_id', and 'quantity', write a query to find the total quantity of items in each warehouse.";"SELECT warehouse_id, SUM(quantity) AS total_quantity FROM inventory GROUP BY warehouse_id;";"SQL";"Easy";"Data Analyst, Warehouse Manager";"SELECT warehouse_id, SUM(quantity) AS total_quantity FROM inventory GROUP BY warehouse_id;";"This sums the item quantities per warehouse.";"Forgetting to group by warehouse_id.";"What is a GROUP BY clause?; How to calculate percentages?"
"5";"Write a SQL query to find the percentage of total sales each product contributes to the overall sales.";"SELECT product_id, (SUM(amount) / (SELECT SUM(amount) FROM sales)) * 100 AS percentage FROM sales GROUP BY product_id;";"SQL";"Advanced";"Data Analyst, Business Analyst";"SELECT product_id, (SUM(amount) / (SELECT SUM(amount) FROM sales)) * 100 AS percentage FROM sales GROUP BY product_id;";"This calculates the sales percentage of each product against total sales.";"Neglecting to consider division by zero.";"What is a subquery?; How to calculate market share?"
"6";"Given a 'customers' table, write a query to find the top 5 customers based on total purchase amount.";"SELECT customer_id, SUM(amount) AS total_purchases FROM purchases GROUP BY customer_id ORDER BY total_purchases DESC LIMIT 5;";"SQL";"Intermediate";"Data Analyst, Business Analyst";"SELECT customer_id, SUM(amount) AS total_purchases FROM purchases GROUP BY customer_id ORDER BY total_purchases DESC LIMIT 5;";"This retrieves the top 5 customers by their total purchase amounts.";"Not using correct ordering or limits.";"What is a ranking function?; How to use TOP in SQL?"
"7";"Assume a 'projects' table with 'project_id', 'start_date', and 'end_date'. Write a SQL query to calculate the total duration of each project in days.";"SELECT project_id, DATEDIFF(end_date, start_date) AS duration FROM projects;";"SQL";"Intermediate";"Project Manager, Data Analyst";"SELECT project_id, DATEDIFF(end_date, start_date) AS duration FROM projects;";"This calculates how long each project has lasted in days.";"Incorrectly using date functions.";"What is the difference between DATEDIFF and TIMESTAMPDIFF?; How to calculate project timelines?"
"8";"Write a SQL query to retrieve the nth highest salary from the 'employees' table.";"SELECT DISTINCT salary FROM employees ORDER BY salary DESC LIMIT 1 OFFSET n-1;";"SQL";"Advanced";"Data Analyst, HR Analyst";"SELECT DISTINCT salary FROM employees ORDER BY salary DESC LIMIT 1 OFFSET n-1;";"This query finds the nth highest salary by using a combination of sorting and limiting.";"Not understanding zero-based indexing.";"What is a window function?; How to handle duplicate values?"
"9";"In a 'sales' table, how would you write a query to find the average sale amount per day?";"SELECT DATE(sale_date) AS sale_day, AVG(amount) AS average_sale FROM sales GROUP BY DATE(sale_date);";"SQL";"Intermediate";"Data Analyst, Business Analyst";"SELECT DATE(sale_date) AS sale_day, AVG(amount) AS average_sale FROM sales GROUP BY DATE(sale_date);";"This computes daily averages of sale amounts.";"Confusing aggregate functions with non-aggregated columns.";"How to calculate weekly averages?; What are time-series analyses?"
"10";"Write a query to find records from a 'users' table where the email field does not contain a valid email format.";"SELECT * FROM users WHERE email NOT LIKE '%_@__%.__%';";"SQL";"Intermediate";"Data Engineer, Data Analyst";"SELECT * FROM users WHERE email NOT LIKE '%_@__%.__%';";"This checks for valid email patterns and filters out invalid ones.";"Overlooking edge cases in email formats.";"What are string functions?; How to validate data integrity?"
"11";"You have a table 'orders' with 'customer_id', 'order_id', and 'order_amount'. Write a query to find the customer with the highest total order amount.";"SELECT customer_id, SUM(order_amount) AS total_amount FROM orders GROUP BY customer_id ORDER BY total_amount DESC LIMIT 1;";"SQL";"Intermediate";"Data Analyst, Business Analyst";"SELECT customer_id, SUM(order_amount) AS total_amount FROM orders GROUP BY customer_id ORDER BY total_amount DESC LIMIT 1;";"This identifies the customer with the most significant financial contribution.";"Failing to account for ties in the output.";"What is ranking in SQL?; How to find top customers?"
"12";"Write a SQL query to list all products that have not been sold.";"SELECT p.product_id, p.product_name FROM products p LEFT JOIN sales s ON p.product_id = s.product_id WHERE s.product_id IS NULL;";"SQL";"Advanced";"Data Analyst, Inventory Manager";"SELECT p.product_id, p.product_name FROM products p LEFT JOIN sales s ON p.product_id = s.product_id WHERE s.product_id IS NULL;";"This identifies products with no entries in the sales table.";"Not understanding LEFT JOIN behavior.";"What is data reconciliation?; How to manage inventory?"
"13";"Given a 'logs' table with 'log_id', 'user_id', and 'timestamp', how would you find the number of distinct users active in the last 7 days?";"SELECT COUNT(DISTINCT user_id) FROM logs WHERE timestamp >= NOW() - INTERVAL '7 days';";"SQL";"Intermediate";"Data Analyst, Business Analyst";"SELECT COUNT(DISTINCT user_id) FROM logs WHERE timestamp >= NOW() - INTERVAL '7 days';";"This counts active unique users based on log entries.";"Incorrect date range handling.";"What are time-based analyses?; How to analyze user engagement?"
"14";"Write a SQL query to determine the average amount spent per transaction by each customer.";"SELECT customer_id, AVG(amount) AS average_spent FROM transactions GROUP BY customer_id;";"SQL";"Intermediate";"Data Analyst, Business Analyst";"SELECT customer_id, AVG(amount) AS average_spent FROM transactions GROUP BY customer_id;";"This calculates average transaction amounts per customer.";"Not grouping correctly.";"What are aggregate functions?; How to analyze spending patterns?"
"15";"In an 'emails' table, write a query to find users who have not verified their email addresses.";"SELECT * FROM users WHERE email_verified = FALSE;";"SQL";"Easy";"Data Analyst, Marketing Analyst";"SELECT * FROM users WHERE email_verified = FALSE;";"This filters for users with unverified email addresses.";"Assuming the verification field is not properly defined.";"How to clean email lists?; What are user engagement techniques?"
"16";"Write a SQL statement to find duplicate entries in a customer database based on email.";"SELECT email, COUNT(*) AS count FROM customers GROUP BY email HAVING COUNT(*) > 1;";"SQL";"Intermediate";"Data Analyst, Data Engineer";"SELECT email, COUNT(*) AS count FROM customers GROUP BY email HAVING COUNT(*) > 1;";"This identifies duplicate customer records based on email.";"Failing to account for case sensitivity.";"What are data cleansing techniques?; How to handle duplicates?"
"17";"Assuming a 'performance' table with 'employee_id', 'score', and 'date', write a query to find the average score per employee for the last month.";"SELECT employee_id, AVG(score) AS average_score FROM performance WHERE date >= DATEADD(month, -1, GETDATE()) GROUP BY employee_id;";"SQL";"Intermediate";"HR Analyst, Data Analyst";"SELECT employee_id, AVG(score) AS average_score FROM performance WHERE date >= DATEADD(month, -1, GETDATE()) GROUP BY employee_id;";"This calculates the average score of employees for the previous month.";"Misunderstanding date handling.";"What are time series analyses?; How to use aggregate functions?"
"18";"Write a query to list all countries with more than 10 cities in a 'cities' table.";"SELECT country, COUNT(city_id) AS city_count FROM cities GROUP BY country HAVING city_count > 10;";"SQL";"Intermediate";"Data Analyst, Urban Planner";"SELECT country, COUNT(city_id) AS city_count FROM cities GROUP BY country HAVING city_count > 10;";"This identifies countries based on the number of cities.";"Not counting correctly or using the HAVING clause wrongly.";"What are aggregation functions?; How to analyze geographic data?"
"19";"Given a 'users' table, write a query to find all users registered in the last 30 days.";"SELECT * FROM users WHERE registration_date >= NOW() - INTERVAL '30 days';";"SQL";"Easy";"Data Analyst, Business Analyst";"SELECT * FROM users WHERE registration_date >= NOW() - INTERVAL '30 days';";"This filters users based on their registration date.";"Incorrectly accounting for the date range.";"What are user retention metrics?; How to perform cohort analysis?"
"20";"You have a 'subscriptions' table with 'user_id', 'plan', and 'start_date'. Write a query to find users who have not renewed their subscriptions.";"SELECT user_id, plan FROM subscriptions WHERE start_date < DATEADD(month, -1, GETDATE());";"SQL";"Intermediate";"Data Analyst, Subscription Manager";"SELECT user_id, plan FROM subscriptions WHERE start_date < DATEADD(month, -1, GETDATE());";"This identifies users whose subscriptions have not been renewed.";"Not considering multiple plans for the same user.";"What are customer lifecycle metrics?; How to analyze subscription data?"
"21";"Write a query to find how many products are out of stock from the 'inventory' table.";"SELECT COUNT(*) AS out_of_stock FROM inventory WHERE quantity = 0;";"SQL";"Easy";"Inventory Manager, Data Analyst";"SELECT COUNT(*) AS out_of_stock FROM inventory WHERE quantity = 0;";"This counts products that are out of stock.";"Failing to distinguish between various stock statuses.";"What is inventory management?; How to forecast inventory needs?"
"22";"In a table 'sales_data', how would you write a query to find the total sales for each month of the current year?";"SELECT MONTH(sale_date) AS sale_month, SUM(amount) AS total_sales FROM sales_data WHERE YEAR(sale_date) = YEAR(CURRENT_DATE) GROUP BY MONTH(sale_date);";"SQL";"Intermediate";"Data Analyst, Financial Analyst";"SELECT MONTH(sale_date) AS sale_month, SUM(amount) AS total_sales FROM sales_data WHERE YEAR(sale_date) = YEAR(CURRENT_DATE) GROUP BY MONTH(sale_date);";"This sums sales amounts by month.";"Not grouping by YEAR if the dataset spans multiple years.";"How to visualize sales trends?; What are time series analyses?"
"23";"You have a 'visits' table with 'user_id' and 'visit_date'. How would you query the unique users who visited in the last week?";"SELECT COUNT(DISTINCT user_id) AS unique_visitors FROM visits WHERE visit_date >= NOW() - INTERVAL '1 week';";"SQL";"Intermediate";"Data Analyst, Marketing Analyst";"SELECT COUNT(DISTINCT user_id) AS unique_visitors FROM visits WHERE visit_date >= NOW() - INTERVAL '1 week';";"This counts distinct users for the last week.";"Misunderstanding DISTINCT functionality.";"What are user engagement metrics?; How to measure website traffic?"
"24";"Write a query to find the total number of orders from each customer along with their IDs.";"SELECT customer_id, COUNT(order_id) AS total_orders FROM orders GROUP BY customer_id;";"SQL";"Easy";"Data Analyst, Business Analyst";"SELECT customer_id, COUNT(order_id) AS total_orders FROM orders GROUP BY customer_id;";"This aggregates orders per customer.";"Forgetting to include all columns if needed.";"What are order fulfillment metrics?; How to calculate customer lifetime value?"
"25";"You have a 'logs' table with 'user_id' and 'action_date'. Write a query to identify users who performed actions on two different days.";"SELECT user_id FROM logs GROUP BY user_id HAVING COUNT(DISTINCT DATE(action_date)) > 1;";"SQL";"Intermediate";"Data Analyst, User Researcher";"SELECT user_id FROM logs GROUP BY user_id HAVING COUNT(DISTINCT DATE(action_date)) > 1;";"This finds users who were active on more than one day.";"Forgetting to handle date functions correctly.";"What are event tracking metrics?; How to analyze user behavior?"
"26";"Assuming an 'online_courses' table with 'course_id', 'subject', and 'registration_date', write a query to find the total number of registrations per subject for last year.";"SELECT subject, COUNT(*) AS total_registrations FROM online_courses WHERE YEAR(registration_date) = YEAR(CURRENT_DATE) - 1 GROUP BY subject;";"SQL";"Intermediate";"Education Analyst, Data Analyst";"SELECT subject, COUNT(*) AS total_registrations FROM online_courses WHERE YEAR(registration_date) = YEAR(CURRENT_DATE) - 1 GROUP BY subject;";"This aggregates registrations by course subject.";"Not efficiently using COUNT with GROUP BY.";"What are enrollment metrics?; How to analyze course effectiveness?"
"27";"Write a SQL query to calculate the customer retention rate from the 'purchases' table.";"SELECT (COUNT(DISTINCT user_id) / (SELECT COUNT(DISTINCT user_id) FROM purchases WHERE purchase_date < DATEADD(year, -1, GETDATE()))) * 100 AS retention_rate FROM purchases WHERE purchase_date >= DATEADD(year, -1, GETDATE());";"SQL";"Advanced";"Data Analyst, Marketing Analyst";"SELECT (COUNT(DISTINCT user_id) / (SELECT COUNT(DISTINCT user_id) FROM purchases WHERE purchase_date < DATEADD(year, -1, GETDATE()))) * 100 AS retention_rate FROM purchases WHERE purchase_date >= DATEADD(year, -1, GETDATE());";"This calculates the retention rate for customers based on prior year purchases.";"Misunderstanding what constitutes a returning customer.";"What is cohort analysis?; How to measure engagement?"
"28";"Write a SQL query to find the most frequently purchased product from 'sales' table.";"SELECT product_id, COUNT(*) AS purchase_count FROM sales GROUP BY product_id ORDER BY purchase_count DESC LIMIT 1;";"SQL";"Intermediate";"Data Analyst, Business Analyst";"SELECT product_id, COUNT(*) AS purchase_count FROM sales GROUP BY product_id ORDER BY purchase_count DESC LIMIT 1;";"This finds the product with the highest sales volume.";"Failing to correctly aggregate purchase counts.";"What are sales performance metrics?; How to analyze product popularity?"
"29";"In a 'sessions' table, how would you write a query to find the average session duration per user?";"SELECT user_id, AVG(TIMESTAMPDIFF(SECOND, start_time, end_time)) AS average_duration FROM sessions WHERE end_time IS NOT NULL GROUP BY user_id;";"SQL";"Intermediate";"Data Analyst, User Researcher";"SELECT user_id, AVG(TIMESTAMPDIFF(SECOND, start_time, end_time)) AS average_duration FROM sessions WHERE end_time IS NOT NULL GROUP BY user_id;";"This calculates the average duration of sessions for each user.";"Confusing start and end times.";"What are session metrics?; How to optimize user experience?"
"30";"Write a SQL query to count how many products are there in stock by category.";"SELECT category, COUNT(*) AS total_products FROM products WHERE stock > 0 GROUP BY category;";"SQL";"Easy";"Inventory Manager, Data Analyst";"SELECT category, COUNT(*) AS total_products FROM products WHERE stock > 0 GROUP BY category;";"This counts products that are in stock, categorized.";"Failing to filter correctly.";"What is stock management?; How to analyze product availability?"
"31";"Assume a 'user_activity' table with 'user_id', 'activity_type', and 'timestamp'. Write a query to find the most common activity type.";"SELECT activity_type, COUNT(*) AS count FROM user_activity GROUP BY activity_type ORDER BY count DESC LIMIT 1;";"SQL";"Intermediate";"Data Analyst, UX Researcher";"SELECT activity_type, COUNT(*) AS count FROM user_activity GROUP BY activity_type ORDER BY count DESC LIMIT 1;";"This finds the activity type with the highest count.";"Not using GROUP BY effectively.";"What are user behavior metrics?; How to analyze trends?"
"32";"Write a SQL query to determine the number of new users registered each month.";"SELECT MONTH(registration_date) AS reg_month, COUNT(*) AS new_users FROM users GROUP BY MONTH(registration_date);";"SQL";"Intermediate";"Data Analyst, Business Analyst";"SELECT MONTH(registration_date) AS reg_month, COUNT(*) AS new_users FROM users GROUP BY MONTH(registration_date);";"This totals new user registrations by month.";"Conflicting date formats.";"What are user growth metrics?; How to analyze registration trends?"
"33";"You have a 'feedback' table with 'user_id', 'rating', and 'comments'. Write a query to find the average rating given by each user.";"SELECT user_id, AVG(rating) AS average_rating FROM feedback GROUP BY user_id;";"SQL";"Intermediate";"Data Analyst, Product Manager";"SELECT user_id, AVG(rating) AS average_rating FROM feedback GROUP BY user_id;";"This determines average feedback ratings per user.";"Not properly handling NULL ratings.";"What are feedback metrics?; How to analyze customer satisfaction?"
"34";"Given a 'subscriptions' table, write a SQL query to calculate the churn rate.";"SELECT (SUM(CASE WHEN status = 'canceled' THEN 1 ELSE 0 END) / COUNT(*)) * 100 AS churn_rate FROM subscriptions;";"SQL";"Advanced";"Data Analyst, Business Analyst";"SELECT (SUM(CASE WHEN status = 'canceled' THEN 1 ELSE 0 END) / COUNT(*)) * 100 AS churn_rate FROM subscriptions;";"This calculates the percentage of canceled subscriptions.";"Ignoring active subscription counts.";"What is customer retention?; How to measure subscription performance?"
"35";"In an 'analytics' table with 'session_id', 'start_time', and 'end_time', write a query to find the average session length.";"SELECT AVG(TIMESTAMPDIFF(SECOND, start_time, end_time)) AS average_session_length FROM analytics;";"SQL";"Intermediate";"Data Analyst, User Researcher";"SELECT AVG(TIMESTAMPDIFF(SECOND, start_time, end_time)) AS average_session_length FROM analytics;";"This gives the average time users spend in sessions.";"Failing to handle session end correctly.";"What are engagement metrics?; How to improve user experience?"
"36";"Write a query to find all employees who have the same manager.";"SELECT e1.id, e1.name, e2.name AS manager_name FROM employees e1 JOIN employees e2 ON e1.manager_id = e2.id;";"SQL";"Intermediate";"HR Analyst, Data Analyst";"SELECT e1.id, e1.name, e2.name AS manager_name FROM employees e1 JOIN employees e2 ON e1.manager_id = e2.id;";"This retrieves employees along with their respective managers.";"Not distinguishing different manager relationships.";"What are organizational structures?; How to analyze team dynamics?"
"37";"Write a SQL query to list products with a quantity less than the average quantity of all products.";"SELECT * FROM products WHERE quantity < (SELECT AVG(quantity) FROM products);";"SQL";"Intermediate";"Inventory Manager, Data Analyst";"SELECT * FROM products WHERE quantity < (SELECT AVG(quantity) FROM products);";"This identifies products that are below average stock level.";"Misunderstanding the scope of aggregate functions.";"What are stock metrics?; How to manage inventory levels?"
"38";"Write a query that retrieves the total revenue generated from each product category.";"SELECT category, SUM(price * quantity_sold) AS total_revenue FROM sales GROUP BY category;";"SQL";"Intermediate";"Data Analyst, Business Analyst";"SELECT category, SUM(price * quantity_sold) AS total_revenue FROM sales GROUP BY category;";"This calculates total revenue by category.";"Failing to multiply price and quantity correctly.";"What are sales analysis techniques?; How to structure financial reports?"
"39";"In a 'messages' table, write a query to count unread messages by user.";"SELECT user_id, COUNT(*) AS unread_count FROM messages WHERE is_read = FALSE GROUP BY user_id;";"SQL";"Easy";"Data Analyst, Communications Manager";"SELECT user_id, COUNT(*) AS unread_count FROM messages WHERE is_read = FALSE GROUP BY user_id;";"This counts unread messages for each user.";"Not handling message status correctly.";"What are communication metrics?; How to improve inbox management?"
"40";"Write a query to find users who signed up in the last 30 days and are in the premium plan.";"SELECT * FROM users WHERE registration_date >= DATEADD(day, -30, GETDATE()) AND plan_type = 'premium';";"SQL";"Easy";"Data Analyst, Marketing Manager";"SELECT * FROM users WHERE registration_date >= DATEADD(day, -30, GETDATE()) AND plan_type = 'premium';";"This filters for recent premium sign-ups.";"Failing to check plan type properly.";"What are user acquisition metrics?; How to optimize planning strategies?"
"41";"You have a 'clicks' table containing 'user_id', 'product_id', and 'timestamp'. Write a query to find users who clicked on more than 5 products in a day.";"SELECT user_id, COUNT(DISTINCT product_id) AS clicks FROM clicks WHERE DATE(timestamp) = CURDATE() GROUP BY user_id HAVING clicks > 5;";"SQL";"Intermediate";"Data Analyst, Marketing Analyst";"SELECT user_id, COUNT(DISTINCT product_id) AS clicks FROM clicks WHERE DATE(timestamp) = CURDATE() GROUP BY user_id HAVING clicks > 5;";"This identifies users who engaged significantly in a day.";"Misunderstanding click counts per user.";"What are engagement metrics?; How to analyze user interactions?"
"42";"Write a SQL query to find all orders that were shipped late.";"SELECT * FROM orders WHERE shipped_date > delivery_date;";"SQL";"Intermediate";"Logistics Manager, Data Analyst";"SELECT * FROM orders WHERE shipped_date > delivery_date;";"This finds orders with delivery issues.";"Not clearly defining late shipments.";"What are logistics metrics?; How to manage delivery times?"
"43";"Given a 'spending' table containing 'user_id', 'amount' and 'date', write a query to find the highest spending day for each user.";"SELECT user_id, date, MAX(amount) AS highest_spending FROM spending GROUP BY user_id, date;";"SQL";"Advanced";"Data Analyst, Financial Analyst";"SELECT user_id, date, MAX(amount) AS highest_spending FROM spending GROUP BY user_id, date;";"This identifies the peak spending day for each user.";"Misunderstanding the grouping-level within the query.";"What are spending habits?; How to analyze financial performance?"
"44";"Write a query to find the average number of clicks per user over the last month.";"SELECT user_id, AVG(click_count) AS average_clicks FROM (SELECT user_id, COUNT(*) AS click_count FROM clicks WHERE timestamp >= DATEADD(month, -1, GETDATE()) GROUP BY user_id);";"SQL";"Intermediate";"Data Analyst, User Researcher";"SELECT user_id, AVG(click_count) AS average_clicks FROM (SELECT user_id, COUNT(*) AS click_count FROM clicks WHERE timestamp >= DATEADD(month, -1, GETDATE()) GROUP BY user_id);";"This summarizes user engagement by click counts.";"Neglecting to wrap the inner query correctly.";"What are engagement metrics?; How to analyze user interaction?"
"45";"Looking at a 'products' table, write a query to find all suppliers with more than 5 products.";"SELECT supplier_id FROM products GROUP BY supplier_id HAVING COUNT(product_id) > 5;";"SQL";"Intermediate";"Data Analyst, Supplier Manager";"SELECT supplier_id FROM products GROUP BY supplier_id HAVING COUNT(product_id) > 5;";"This identifies suppliers with a larger product catalog.";"Not correctly applying the HAVING clause.";"What are product management techniques?; How to evaluate supplier performance?"
"46";"In a 'subscriptions' table with 'user_id', 'start_date', and 'end_date', write a query to retrieve active subscriptions.";"SELECT * FROM subscriptions WHERE end_date IS NULL OR end_date > NOW();";"SQL";"Easy";"Data Analyst, Subscription Manager";"SELECT * FROM subscriptions WHERE end_date IS NULL OR end_date > NOW();";"This retrieves current subscriptions for users.";"Confusing active with expired subscriptions.";"What are retention metrics?; How to evaluate customer engagement?"
"47";"Write a SQL query to find all customers who purchased the same product more than once.";"SELECT customer_id, product_id, COUNT(*) AS purchase_count FROM purchases GROUP BY customer_id, product_id HAVING purchase_count > 1;";"SQL";"Intermediate";"Data Analyst, Marketing Analyst";"SELECT customer_id, product_id, COUNT(*) AS purchase_count FROM purchases GROUP BY customer_id, product_id HAVING purchase_count > 1;";"This highlights repeat customers for specific products.";"Not accounting for the grouping correctly.";"What are customer loyalty metrics?; How to evaluate product performance?"
"48";"Assuming you have a 'visits' table with 'user_id', 'visit_date', and 'duration', write a query to calculate the total time spent by all users this month.";"SELECT SUM(duration) AS total_time FROM visits WHERE MONTH(visit_date) = MONTH(CURRENT_DATE);";"SQL";"Intermediate";"Data Analyst, Marketing Analyst";"SELECT SUM(duration) AS total_time FROM visits WHERE MONTH(visit_date) = MONTH(CURRENT_DATE);";"This sums total visit time for the current month.";"Neglecting to group or filter for the right date.";"What are engagement metrics?; How to analyze user activity?"
"49";"Write a query to find product categories with no products in stock.";"SELECT DISTINCT category FROM products WHERE quantity = 0;";"SQL";"Intermediate";"Inventory Manager, Data Analyst";"SELECT DISTINCT category FROM products WHERE quantity = 0;";"This identifies categories lacking stock.";"Misunderstanding groupings for empty categories.";"What are stock management strategies?; How to evaluate product performance?"
"50";"Given an 'appointments' table containing 'customer_id', 'appointment_date', and 'canceled' flag, write a query to calculate the cancellation rate.";"SELECT (SUM(CASE WHEN canceled = 1 THEN 1 ELSE 0 END) / COUNT(*)) * 100 AS cancellation_rate FROM appointments;";"SQL";"Advanced";"Data Analyst, Business Analyst";"SELECT (SUM(CASE WHEN canceled = 1 THEN 1 ELSE 0 END) / COUNT(*)) * 100 AS cancellation_rate FROM appointments;";"This calculates the percentage of canceled appointments.";"Not accounting for cases with no appointments.";"What are retention metrics?; How to manage appointment scheduling?"
